package TestNG_Practice;

import java.io.File;
import java.io.IOException;

import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import jxl.Cell;
import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;
import jxl.write.Label;

public class DDT2 {
	//add Test annotation
	@Test(dataProvider="testdata")
	
	public void addition(String val1, String val2, String val3 ) {//java reads intgers as string during run time
		
		//different between  reading string type data and int type data from excel
		//String type data: we can read it as it is 
		//Integer type data: we must convert it to string, becuase even if the data is stored as an int in the excel it will read it as a string 
		//convert the data before addition, from string to integer
		int num1=Integer.parseInt(val1);//only one value at a time
		int num2 =Integer.parseInt(val2);
		int num3= Integer.parseInt(val3);
		int result = num1+num2+num3;
		System.out.println("the result is "+result);
		Label label = new Label(4, 0, "result");
		 
	}
	
	//add data provider annotation
	
	@DataProvider(name="testdata")
	
	
//make it as an array object instead of main method
	public Object [][] readExcel()throws BiffException, IOException {
	//public static void main(String[] args) throws BiffException, IOException {

//Read Test Data (Integer Type) from excel file and perform Data Driven Testing For Addition Functionality.
		
		//import the file
		
		File file= new File("E:\\1.PeopleinTech\\1.Selenuim\\All_files\\Working with excell\\Addition.xls");
		
		//Workbook instance
		Workbook wkbk=Workbook.getWorkbook(file);
		
		//sheet instance
		
		Sheet sheet=wkbk.getSheet("DataSheet");
		
		int rows =sheet.getRows();
		
		int columns =sheet.getColumns();
		
		System.out.println("the rows are "+rows);
		
		System.out.println("the columns are "+columns);
	
		String inputData [][] =new String [rows] [columns];
		
		for (int i=0; i<rows; i++) {
			for (int j=0; j<columns; j++) {
				
				Cell cell=sheet.getCell(j, i);
				
				//pass j and i to string array
				inputData[i] [j]=cell.getContents();
				
				//optional 
				System.out.println(inputData[i][j]);
				//make it as an array object instead of main method line 13
				
			}
			
		}
		return inputData;
		
		
		//Assignments:
		//i) after assert fails then close the browser
		//ii) reada data from excel(range of records)
		//iii)
		
		
	}

}
